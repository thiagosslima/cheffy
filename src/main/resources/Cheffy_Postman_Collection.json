{
	"info": {
		"name": "Cheffy API - Tech Challenge FIAP",
		"description": "Collection completa para testes da API Cheffy com cenários de sucesso e falha",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080/api/v1",
			"type": "string"
		},
		{
			"key": "token",
			"value": "",
			"type": "string"
		},
		{
			"key": "userId",
			"value": "",
			"type": "string"
		},
		{
			"key": "addressId",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "1. Autenticação",
			"item": [
				{
					"name": "✅ Login Sucesso - Cliente",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));",
									"pm.test('Token exists', () => {",
									"    const json = pm.response.json();",
									"    pm.expect(json.token).to.exist;",
									"    pm.collectionVariables.set('token', json.token);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [{"key": "Content-Type", "value": "application/json"}],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"login\": \"joao.silva\",\n  \"password\": \"SenhaForte@123456\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["auth", "login"]
						}
					}
				},
				{
					"name": "❌ Login Falhou - Credenciais Inválidas",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 401', () => pm.response.to.have.status(401));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [{"key": "Content-Type", "value": "application/json"}],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"login\": \"joao.silva\",\n  \"password\": \"SenhaErrada123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["auth", "login"]
						}
					}
				},
				{
					"name": "❌ Login Falhou - Campos Ausentes",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 400', () => pm.response.to.have.status(400));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [{"key": "Content-Type", "value": "application/json"}],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"login\": \"\",\n  \"password\": \"\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": ["{{baseUrl}}"],
							"path": ["auth", "login"]
						}
					}
				}
			]
		},
		{
			"name": "2. Gerenciamento de Usuários",
			"item": [
				{
					"name": "✅ Criar Usuário - Cliente",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 201', () => pm.response.to.have.status(201));",
									"pm.test('User ID returned', () => {",
									"    const userId = pm.response.text().replace(/\"/g, '');",
									"    pm.expect(userId).to.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/);",
									"    pm.collectionVariables.set('userId', userId);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [{"key": "Content-Type", "value": "application/json"}],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"João Silva\",\n  \"email\": \"joao.silva@email.com\",\n  \"login\": \"joao.silva\",\n  \"password\": \"SenhaForte@123456\",\n  \"profileType\": \"CLIENT\",\n  \"address\": {\n    \"streetName\": \"Rua das Flores\",\n    \"number\": 123,\n    \"city\": \"São Paulo\",\n    \"postalCode\": \"12345678\",\n    \"neighborhood\": \"Centro\",\n    \"stateProvince\": \"SP\",\n    \"main\": true\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": ["{{baseUrl}}"],
							"path": ["users"]
						}
					}
				},
				{
					"name": "✅ Criar Usuário - Dono de Restaurante",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 201', () => pm.response.to.have.status(201));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [{"key": "Content-Type", "value": "application/json"}],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Maria Restaurante\",\n  \"email\": \"maria.owner@email.com\",\n  \"login\": \"maria.owner\",\n  \"password\": \"SenhaSegura@789\",\n  \"profileType\": \"OWNER\",\n  \"address\": {\n    \"streetName\": \"Av Paulista\",\n    \"number\": 1000,\n    \"city\": \"São Paulo\",\n    \"postalCode\": \"87654321\",\n    \"neighborhood\": \"Bela Vista\",\n    \"stateProvince\": \"SP\",\n    \"main\": true\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": ["{{baseUrl}}"],
							"path": ["users"]
						}
					}
				},
				{
					"name": "❌ Criar Usuário - Senha Fraca",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 400', () => pm.response.to.have.status(400));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [{"key": "Content-Type", "value": "application/json"}],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Teste Senha\",\n  \"email\": \"teste@email.com\",\n  \"login\": \"teste.senha\",\n  \"password\": \"123\",\n  \"profileType\": \"CLIENT\",\n  \"address\": {\n    \"streetName\": \"Rua Teste\",\n    \"number\": 1,\n    \"city\": \"São Paulo\",\n    \"postalCode\": \"12345678\",\n    \"neighborhood\": \"Centro\",\n    \"stateProvince\": \"SP\",\n    \"main\": true\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": ["{{baseUrl}}"],
							"path": ["users"]
						}
					}
				},
				{
					"name": "❌ Criar Usuário - Email Inválido",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 400', () => pm.response.to.have.status(400));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [{"key": "Content-Type", "value": "application/json"}],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Teste Email\",\n  \"email\": \"email-invalido\",\n  \"login\": \"teste.email\",\n  \"password\": \"SenhaForte@123456\",\n  \"profileType\": \"CLIENT\",\n  \"address\": {\n    \"streetName\": \"Rua Teste\",\n    \"number\": 1,\n    \"city\": \"São Paulo\",\n    \"postalCode\": \"12345678\",\n    \"neighborhood\": \"Centro\",\n    \"stateProvince\": \"SP\",\n    \"main\": true\n  }\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": ["{{baseUrl}}"],
							"path": ["users"]
						}
					}
				},
				{
					"name": "❌ Criar Usuário - Campos Obrigatórios Ausentes",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 400', () => pm.response.to.have.status(400));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [{"key": "Content-Type", "value": "application/json"}],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Teste Incompleto\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": ["{{baseUrl}}"],
							"path": ["users"]
						}
					}
				},
				{
					"name": "✅ Listar Todos os Usuários",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));",
									"pm.test('Returns array', () => {",
									"    const json = pm.response.json();",
									"    pm.expect(json).to.be.an('array');",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [{"key": "Authorization", "value": "Bearer {{token}}"}],
						"url": {
							"raw": "{{baseUrl}}/users",
							"host": ["{{baseUrl}}"],
							"path": ["users"]
						}
					}
				},
				{
					"name": "✅ Buscar Usuário por ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));",
									"pm.test('User data exists', () => {",
									"    const json = pm.response.json();",
									"    pm.expect(json.id).to.exist;",
									"    pm.expect(json.name).to.exist;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [{"key": "Authorization", "value": "Bearer {{token}}"}],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}"]
						}
					}
				},
				{
					"name": "✅ Buscar Usuário por Nome",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [{"key": "Authorization", "value": "Bearer {{token}}"}],
						"url": {
							"raw": "{{baseUrl}}/users/name/João Silva",
							"host": ["{{baseUrl}}"],
							"path": ["users", "name", "João Silva"]
						}
					}
				},
				{
					"name": "❌ Buscar Usuário - Não Encontrado",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 404', () => pm.response.to.have.status(404));"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [{"key": "Authorization", "value": "Bearer {{token}}"}],
						"url": {
							"raw": "{{baseUrl}}/users/00000000-0000-0000-0000-000000000000",
							"host": ["{{baseUrl}}"],
							"path": ["users", "00000000-0000-0000-0000-000000000000"]
						}
					}
				},
				{
					"name": "❌ Buscar Usuário - Sem Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 403', () => pm.response.to.have.status(403));"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}"]
						}
					}
				},
				{
					"name": "✅ Atualizar Usuário",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204', () => pm.response.to.have.status(204));"
								]
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{"key": "Authorization", "value": "Bearer {{token}}"},
							{"key": "Content-Type", "value": "application/json"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"João Silva Atualizado\",\n  \"email\": \"joao.silva.novo@email.com\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}"]
						}
					}
				},
				{
					"name": "❌ Atualizar Usuário - Email Inválido",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 400', () => pm.response.to.have.status(400));"
								]
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{"key": "Authorization", "value": "Bearer {{token}}"},
							{"key": "Content-Type", "value": "application/json"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"email-invalido\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}"]
						}
					}
				},
				{
					"name": "✅ Atualizar Senha",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));"
								]
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{"key": "Authorization", "value": "Bearer {{token}}"},
							{"key": "Content-Type", "value": "application/json"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"password\": \"NovaSenhaForte@999\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}/password",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}", "password"]
						}
					}
				},
				{
					"name": "❌ Atualizar Senha - Senha Fraca",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 400', () => pm.response.to.have.status(400));"
								]
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{"key": "Authorization", "value": "Bearer {{token}}"},
							{"key": "Content-Type", "value": "application/json"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"password\": \"123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}/password",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}", "password"]
						}
					}
				}
			]
		},
		{
			"name": "3. Gerenciamento de Endereços",
			"item": [
				{
					"name": "✅ Adicionar Endereço",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 201', () => pm.response.to.have.status(201));",
									"pm.test('Address ID returned', () => {",
									"    const addressId = pm.response.text();",
									"    pm.collectionVariables.set('addressId', addressId);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{"key": "Authorization", "value": "Bearer {{token}}"},
							{"key": "Content-Type", "value": "application/json"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"streetName\": \"Rua Nova\",\n  \"number\": 456,\n  \"city\": \"Rio de Janeiro\",\n  \"postalCode\": \"20000000\",\n  \"neighborhood\": \"Copacabana\",\n  \"stateProvince\": \"RJ\",\n  \"main\": false\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}/addresses",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}", "addresses"]
						}
					}
				},
				{
					"name": "❌ Adicionar Endereço - Campos Ausentes",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 400', () => pm.response.to.have.status(400));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{"key": "Authorization", "value": "Bearer {{token}}"},
							{"key": "Content-Type", "value": "application/json"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"streetName\": \"Rua Incompleta\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}/addresses",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}", "addresses"]
						}
					}
				},
				{
					"name": "❌ Adicionar Endereço - Usuário Não Encontrado",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 404', () => pm.response.to.have.status(404));"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{"key": "Authorization", "value": "Bearer {{token}}"},
							{"key": "Content-Type", "value": "application/json"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"streetName\": \"Rua Teste\",\n  \"number\": 1,\n  \"city\": \"São Paulo\",\n  \"postalCode\": \"12345678\",\n  \"neighborhood\": \"Centro\",\n  \"stateProvince\": \"SP\",\n  \"main\": false\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/00000000-0000-0000-0000-000000000000/addresses",
							"host": ["{{baseUrl}}"],
							"path": ["users", "00000000-0000-0000-0000-000000000000", "addresses"]
						}
					}
				},
				{
					"name": "✅ Atualizar Endereço",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204', () => pm.response.to.have.status(204));"
								]
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{"key": "Authorization", "value": "Bearer {{token}}"},
							{"key": "Content-Type", "value": "application/json"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"streetName\": \"Rua Atualizada\",\n  \"number\": 789,\n  \"city\": \"Rio de Janeiro\",\n  \"postalCode\": \"20000000\",\n  \"neighborhood\": \"Ipanema\",\n  \"stateProvince\": \"RJ\",\n  \"main\": false\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}/addresses/{{addressId}}",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}", "addresses", "{{addressId}}"]
						}
					}
				},
				{
					"name": "❌ Atualizar Endereço - Não Encontrado",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 404', () => pm.response.to.have.status(404));"
								]
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{"key": "Authorization", "value": "Bearer {{token}}"},
							{"key": "Content-Type", "value": "application/json"}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"streetName\": \"Rua Teste\",\n  \"number\": 1,\n  \"city\": \"São Paulo\",\n  \"postalCode\": \"12345678\",\n  \"neighborhood\": \"Centro\",\n  \"stateProvince\": \"SP\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}/addresses/99999",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}", "addresses", "99999"]
						}
					}
				},
				{
					"name": "✅ Remover Endereço",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204', () => pm.response.to.have.status(204));"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [{"key": "Authorization", "value": "Bearer {{token}}"}],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}/addresses/{{addressId}}",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}", "addresses", "{{addressId}}"]
						}
					}
				},
				{
					"name": "❌ Remover Endereço - Não Encontrado",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 404', () => pm.response.to.have.status(404));"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [{"key": "Authorization", "value": "Bearer {{token}}"}],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}/addresses/99999",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}", "addresses", "99999"]
						}
					}
				}
			]
		},
		{
			"name": "4. Gerenciamento de Perfis",
			"item": [
				{
					"name": "✅ Listar Todos os Perfis",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 200', () => pm.response.to.have.status(200));",
									"pm.test('Returns array with profiles', () => {",
									"    const json = pm.response.json();",
									"    pm.expect(json).to.be.an('array');",
									"    pm.expect(json.length).to.be.greaterThan(0);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/profiles",
							"host": ["{{baseUrl}}"],
							"path": ["profiles"]
						}
					}
				}
			]
		},
		{
			"name": "5. Limpeza",
			"item": [
				{
					"name": "✅ Deletar Usuário",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 204', () => pm.response.to.have.status(204));"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [{"key": "Authorization", "value": "Bearer {{token}}"}],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}"]
						}
					}
				},
				{
					"name": "❌ Deletar Usuário - Não Encontrado",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 404', () => pm.response.to.have.status(404));"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [{"key": "Authorization", "value": "Bearer {{token}}"}],
						"url": {
							"raw": "{{baseUrl}}/users/00000000-0000-0000-0000-000000000000",
							"host": ["{{baseUrl}}"],
							"path": ["users", "00000000-0000-0000-0000-000000000000"]
						}
					}
				},
				{
					"name": "❌ Deletar Usuário - Sem Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status 403', () => pm.response.to.have.status(403));"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/users/{{userId}}",
							"host": ["{{baseUrl}}"],
							"path": ["users", "{{userId}}"]
						}
					}
				}
			]
		}
	]
}
